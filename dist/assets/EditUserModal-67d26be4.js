import{C as T,b as D,U as R,R as $}from"./maska-92f82d47.js";import{d as j,r as o,w as L,_ as q,a as O,u as P,o as w,h as I,f as M,q as E,b as r,j as S,v as A,i as U,c as z,e as k,F as G,g as F}from"./index-a048b658.js";const H=j({components:{CustomButton:T,CustomModal:D},props:{modalTitle:{type:String,default:"Редактировать пользователя"},editModalActive:{type:Boolean,default:!1},editToggleModal:{type:Function,required:!0},errorMessage:String,brands:Array,branches:Array,user:Object,defaultOption:{type:Object,required:!0}},setup(e){const l=o(""),b=o(""),h=o(""),s=o(""),m=o(null),n=o([]),p=o(!1),g=$,d=o((e==null?void 0:e.brands)??[]),c=o((e==null?void 0:e.branches)??[]);L(()=>e.user,a=>{var v;d.value=(e==null?void 0:e.brands)??[],c.value=(e==null?void 0:e.branches)??[],l.value=a.first_name,b.value=a.last_name,h.value=a.phone,s.value=a.role;const i=(v=c.value.find(f=>f.title==a.branch_title))==null?void 0:v.id;m.value=i;const t=[];for(let f=0;f<a.brands.length;f++)for(let N=0;N<d.value.length;N++)if(a.brands[f]==d.value[N].title){t.push(d.value[N].id);break}n.value=t,u()});const B=(a,i)=>i.label.toLowerCase().indexOf(a.toLowerCase())>=0,C=a=>{s.value=a,e.defaultOption.role=a,u()},y=a=>{m.value=a,u()},V=a=>{n.value=a,u()},u=()=>{l.value.length>0&&b.value.length>0&&h.value.length==16&&s.value.length>0&&(s.value=="owner"||s.value=="company_viewer"||m.value&&n.value.length>0)?p.value=!0:p.value=!1};return{firstName:l,lastName:b,telephoneNumber:h,selectedRole:s,selectedBranchId:m,selectedBrandsIds:n,filterOption:B,onRoleSelected:C,onBranchSelected:y,onBrandSelected:V,validate:u,isAllDataEntered:p,roleOptions:g}},directives:{maska:R},data(){return{maskedValue:"",bindedObject:{masked:"",unmasked:"",completed:!1},newUser:this.$props.user}},methods:{onSaveButtonClick(e){this.$emit("editUser",{firstName:this.firstName,lastName:this.lastName,telephoneNumber:this.telephoneNumber,role:this.selectedRole,brand_ids:this.selectedBrandsIds,branch_id:this.selectedBranchId,id:e})}}});const J={class:"modal-content"},K={class:"button-box"};function Q(e,l,b,h,s,m){const n=O("a-select"),p=O("a-alert"),g=O("CustomButton"),d=O("CustomModal"),c=P("maska");return w(),I(d,{onClose:E(e.editToggleModal,["prevent"]),modalActive:e.editModalActive,"modal-title":e.modalTitle},{default:M(()=>{var B,C,y,V,u,a,i;return[r("div",J,[r("form",{onSubmit:l[12]||(l[12]=E(t=>{var v;return e.onSaveButtonClick(((v=e.user)==null?void 0:v.id)??0)},["prevent"]))},[S(r("input",{placeholder:"Имя",type:"text","onUpdate:modelValue":l[0]||(l[0]=t=>e.firstName=t),onInput:l[1]||(l[1]=(...t)=>e.validate&&e.validate(...t)),class:"inputFirstName"},null,544),[[A,e.firstName]]),S(r("input",{placeholder:"Фамилия",type:"text","onUpdate:modelValue":l[2]||(l[2]=t=>e.lastName=t),onInput:l[3]||(l[3]=(...t)=>e.validate&&e.validate(...t)),class:"inputLastName"},null,544),[[A,e.lastName]]),S(r("input",{placeholder:"+7 ___ ___ __ __","data-maska":"+7 ### ### ## ##","onUpdate:modelValue":l[4]||(l[4]=t=>e.telephoneNumber=t),onInput:l[5]||(l[5]=(...t)=>e.validate&&e.validate(...t)),class:"inputTelephone"},null,544),[[c],[A,e.telephoneNumber]]),(((C=(B=e.defaultOption)==null?void 0:B.role)==null?void 0:C.length)??0)>0?(w(),I(n,{key:0,modelValue:e.selectedRole,"onUpdate:modelValue":l[6]||(l[6]=t=>e.selectedRole=t),defaultValue:e.defaultOption.role,placeholder:"Выберите роль",style:{width:"100%"},options:e.roleOptions.map(t=>({label:t.text,value:t.value})),onChange:l[7]||(l[7]=t=>e.onRoleSelected(t))},null,8,["modelValue","defaultValue","options"])):U("",!0),(((V=(y=e.defaultOption)==null?void 0:y.role)==null?void 0:V.length)??0)&&e.defaultOption.role!="owner"&&e.defaultOption.role!="company_viewer"?(w(),z(G,{key:1},[k(n,{modelValue:e.selectedBranchId,"onUpdate:modelValue":l[8]||(l[8]=t=>e.selectedBranchId=t),defaultValue:e.defaultOption.branchId,"show-search":"",placeholder:"Выберите филиал",style:{width:"100%",margin:"24px auto"},options:(u=e.branches)==null?void 0:u.map(t=>({label:t.title.toString(),value:t.id})),"filter-option":e.filterOption,onChange:l[9]||(l[9]=t=>e.onBranchSelected(t))},null,8,["modelValue","defaultValue","options","filter-option"]),k(n,{modelValue:e.selectedBrandsIds,"onUpdate:modelValue":l[10]||(l[10]=t=>e.selectedBrandsIds=t),mode:"multiple",defaultValue:e.defaultOption.brandIds,"show-search":"",placeholder:"Выберите бренд",class:"selector-with_multiple-select",options:(a=e.brands)==null?void 0:a.map(t=>({label:t.title.toString(),value:t.id})),"filter-option":e.filterOption,onChange:l[11]||(l[11]=t=>e.onBrandSelected(t)),showArrow:""},null,8,["modelValue","defaultValue","options","filter-option"])],64)):U("",!0),(((i=e.errorMessage)==null?void 0:i.length)??0)>0?(w(),I(p,{key:2,type:"error",style:{"margin-top":"16px"},message:e.errorMessage,"show-icon":""},null,8,["message"])):U("",!0),r("div",K,[k(g,{onClick:e.editToggleModal,type:"button","additional-styles":{color:"#333",border:"1px solid #999",opacity:"0.5",background:"#FFF"}},{default:M(()=>[F(" Закрыть ")]),_:1},8,["onClick"]),k(g,{type:"submit","additional-styles":{opacity:`${e.isAllDataEntered?"1":"0.5"}`},disabled:!e.isAllDataEntered},{default:M(()=>[F(" Сохранить ")]),_:1},8,["additional-styles","disabled"])])],32)])]}),_:1},8,["onClose","modalActive","modal-title"])}const Y=q(H,[["render",Q],["__scopeId","data-v-0884fdf7"]]);export{Y as E};
